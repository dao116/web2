<!DOCTYPE html>
<html>
<head>
    <title>支付宝跳转演示</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script>
        function redirectToAlipay(token) {
            const scheme = `alipays://platformapi/startapp?appId=20000067&url=${encodeURIComponent(`https://web2.vercel.app/?token=${token}`)}`;
            window.location.href = scheme;

            setTimeout(() => {
                if (!document.hidden) {
                    document.getElementById('qr-container').style.display = 'block';
                    generateQRCode(token);
                }
            }, 1500);
        }

        function generateQRCode(token) {
            const qrData = `https://web2.vercel.app/?token=${token}`;
            document.getElementById('qr-code').innerHTML =
                `<img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(qrData)}" 
                      alt="支付宝支付二维码">`;
        }

        window.onload = function () {
            const urlParams = new URLSearchParams(window.location.search);
            const token = urlParams.get('token') || 'demo_token_123456';
            redirectToAlipay(token);
        };
    </script>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
        .container { max-width: 500px; margin: 0 auto; }
        #qr-container { display: none; margin-top: 30px; }
        button { padding: 12px 24px; background: #1677ff; color: white;
            border: none; border-radius: 4px; cursor: pointer; }
        .warning { color: #f5222d; background: #fff1f0; padding: 15px;
            border: 1px solid #ffa39e; margin: 20px 0; }
    </style>
</head>
<body>
<div class="container">
    <h2>支付宝支付跳转演示</h2>
    <div class="warning"></div>
    <p>正在尝试跳转到支付宝APP...</p>
    <div id="qr-container">
        <p>跳转失败，请扫码支付：</p>
        <div id="qr-code"></div>
        <p>或 <button onclick="redirectToAlipay()">重试跳转</button></p>
    </div>
</div>
</body>
</html>

